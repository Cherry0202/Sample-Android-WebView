(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-048a835f"],{"43fc":function(t,e,n){"use strict";n.r(e);n("b0c0");var u=n("7a23"),c=Object(u["N"])("data-v-7e1751f9");Object(u["y"])("data-v-7e1751f9");var r={class:"bg-area"},s={class:"course-info"},o={class:"course-title"},i={class:"teacher-name"},a={class:"wrap"},l={class:"submit-btn"};Object(u["w"])();var d=c((function(t,e,n,c,d,b){var j,m,v,f,O=Object(u["D"])("Header");return Object(u["v"])(),Object(u["f"])(u["a"],null,[Object(u["j"])("div",r,[Object(u["j"])("img",{src:null===(j=t.course)||void 0===j?void 0:j.image,alt:"",class:"bg-image"},null,8,["src"]),Object(u["j"])(O,{title:t.$t("question.title"),color:"#fff"},null,8,["title"]),Object(u["j"])("div",s,[Object(u["j"])("p",o,Object(u["F"])(null===(m=t.course)||void 0===m?void 0:m.title),1),Object(u["j"])("p",null,[Object(u["j"])("img",{src:null===(v=t.instructor)||void 0===v?void 0:v.icon,alt:"teacher-icon",class:"face-icon"},null,8,["src"]),Object(u["j"])("span",i,Object(u["F"])(null===(f=t.instructor)||void 0===f?void 0:f.name),1)])])]),Object(u["j"])("div",a,[Object(u["j"])("form",{onSubmit:e[2]||(e[2]=Object(u["M"])((function(){return t.submit.apply(t,arguments)}),["prevent"])),class:"question-form"},[Object(u["j"])("label",null,[Object(u["L"])(Object(u["j"])("textarea",{"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.state.comment=e}),cols:"30",rows:"10",placeholder:t.$t("question.input-contents"),class:"question-content"},null,8,["placeholder"]),[[u["I"],t.state.comment]])]),Object(u["j"])("button",l,Object(u["F"])(t.$t("question.submit-btn")),1)],32)])],64)})),b=n("0418"),j=n("6c02"),m=n("5502"),v=n("1840"),f=n("8785"),O=n("00b9");function p(){var t=Object(f["a"])(["\n  query QuestionForm($id: uuid, $student_id: uuid) {\n    SubscriptionCourses(where: { id: { _eq: $id } }) {\n      course_id\n      Course {\n        image\n        title\n        Instructor {\n          icon\n          name\n          id\n        }\n        ChatRooms(where: { student_id: { _eq: $student_id } }) {\n          id\n        }\n      }\n    }\n  }\n"]);return p=function(){return t},t}var g=Object(O["gql"])(p()),h=g;function _(){var t=Object(f["a"])(['\n  mutation InsertChatRoom($student_id: uuid, $course_id: Int, $message: String) {\n    insert_ChatRooms(\n      objects: {\n        student_id: $student_id\n        course_id: $course_id\n        Chats: {\n          data: [\n            { sender: student, message: $message }\n            { sender: instructor, message: "ご質問ありがとうございます！ 順番に返信いたしますので今しばらくお待ち下さいませ。" }\n          ]\n        }\n      }\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n']);return _=function(){return t},t}var C=Object(O["gql"])(_()),$=C,q=Object(u["k"])({components:{Header:b["a"]},setup:function(){var t,e=Object(u["z"])({comment:""}),n=Object(j["c"])(),c=n.currentRoute,r=c.value.query.course_id,s=Object(m["b"])(),o=Object(j["c"])(),i=Object(v["c"])(h,{id:r,student_id:null===(t=s.state.currentUser)||void 0===t?void 0:t.uid}),a=i.result,l=i.onResult,d=i.refetch;d();var b=Object(v["d"])(a,null,(function(t){return t.SubscriptionCourses[0].Course})),f=Object(v["d"])(a,null,(function(t){return t.SubscriptionCourses[0].Course.Instructor})),O=Object(v["d"])(a,null,(function(t){return t.SubscriptionCourses[0].course_id}));l((function(t){var e=t.data.SubscriptionCourses[0].Course.ChatRooms;e.length&&o.push({name:"TakeCourseDetail",query:{id:r}})}));var p=Object(v["b"])($,(function(){var t;return{variables:{course_id:O.value,student_id:null===(t=s.state.currentUser)||void 0===t?void 0:t.uid,message:e.comment}}})),g=p.mutate,_=p.onDone,C=function(){g()};return _((function(t){var e,n,u=null===(e=t.data)||void 0===e||null===(n=e.insert_ChatRooms)||void 0===n?void 0:n.returning[0].id;console.log(u),o.push({name:"NoticeMessage",params:{id:u}})})),{state:e,course:b,instructor:f,submit:C}}});n("91e1");q.render=d,q.__scopeId="data-v-7e1751f9";e["default"]=q},"6e52":function(t,e,n){},"91e1":function(t,e,n){"use strict";n("6e52")},b0c0:function(t,e,n){var u=n("83ab"),c=n("9bf2").f,r=Function.prototype,s=r.toString,o=/^\s*function ([^ (]*)/,i="name";u&&!(i in r)&&c(r,i,{configurable:!0,get:function(){try{return s.call(this).match(o)[1]}catch(t){return""}}})}}]);
//# sourceMappingURL=chunk-048a835f.066fc284.js.map